private void combineFiles(Path destinationDir) throws Exception {

    Path combinedFile = destinationDir.resolve(
            props.getCombine().getOutputFile()
    );

    try (BufferedWriter writer = Files.newBufferedWriter(
            combinedFile,
            StandardCharsets.UTF_8,
            StandardOpenOption.CREATE,
            StandardOpenOption.TRUNCATE_EXISTING
    )) {

        List<String> sourcePaths = props.getSourcePaths();

        for (int i = 0; i < sourcePaths.size(); i++) {
            String sourcePath = sourcePaths.get(i);

            Path file = destinationDir.resolve(
                    Path.of(sourcePath).getFileName().toString()
            );

            if (!Files.exists(file)) {
                throw new IllegalStateException("Expected file not found: " + file);
            }

            Files.lines(file, StandardCharsets.UTF_8).forEach(line -> {
                try {
                    writer.write(line);
                    writer.newLine();
                } catch (Exception e) {
                    throw new RuntimeException(e);
                }
            });

            if (i < sourcePaths.size() - 1) {
                writer.newLine();
                writer.write(props.getCombine().getSeparator());
                writer.newLine();
                writer.newLine();
            }
        }
    }

    System.out.println("Combined markdown created with preserved order: "
            + combinedFile.getFileName());
}
